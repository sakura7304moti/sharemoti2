import{Q as le}from"./QPage.82e76fcb.js";import{r as i,d as x,k as ue,_ as ee,a as J,o as m,aa as A,e as l,b as u,w as d,c as y,ac as ae,ad as B,ae as T,ab as F,Q as C,f as I,af as P,ag as j,g as q,ah as ne}from"./index.14a7c722.js";import{u as se,Q as L}from"./use-quasar.7a6bd282.js";import{Q as G,a as K,b as X,c as de}from"./QTable.8542a644.js";import{Q as Z}from"./QCardSection.d3461790.js";import{Q as W}from"./QCard.856b109b.js";import{Q as z}from"./QDialog.946db96e.js";import{Q as ie}from"./QField.3dd07fc9.js";import{a as M}from"./WordList2Api.72b95cb1.js";import{l as re}from"./LockIcon.df8f6aff.js";import"./BaseApi.ab9ec937.js";import"./use-dark.7ce8ffd6.js";import"./focus-manager.02955f48.js";import"./QSeparator.2e92d9dc.js";import"./QList.0b3bac39.js";import"./QSelect.c55664e6.js";import"./QChip.15935488.js";import"./QItem.0cb08ef4.js";import"./QItemLabel.d7165eea.js";import"./position-engine.ef89f240.js";import"./use-tick.7b8fea28.js";import"./use-prevent-scroll.49273e16.js";import"./format.2a3572e1.js";import"./QCheckbox.9468544f.js";import"./use-checkbox.812d2cd3.js";function ce(){const e=se(),t=i(!1),f=i(!1),E=[{name:"word",label:"\u540D\u8A00",field:"word",sortable:!0},{name:"desc",label:"\u8A73\u7D30",field:"desc",sortable:!0},{name:"createAt",label:"\u4F5C\u6210\u65E5",field:"createAt",sortable:!0},{name:"updateAt",label:"\u66F4\u65B0\u65E5",field:"updateAt",sortable:!0}],b=i(""),v=i({word:"",desc:""}),h=i({word:"",desc:""}),w=i(!1),o=i(!1),r=i(!1),R=i(!0),p=i([]);function D(a,c){const n=new Date(a);return n.setHours(n.getHours()+c),n}function U(a){const c=a.getFullYear(),n=(a.getMonth()+1).toString().padStart(2,"0"),s=a.getDate().toString().padStart(2,"0");return`${c}-${n}-${s}`}function Q(a){const c=new Date(a),n=D(c,7);return U(n)}const V=async function(){w.value=!0,await M.search({text:b.value}).then(a=>{var c;a&&(console.log("response",a),p.value.splice(0),(c=a.records)==null||c.forEach(n=>{var s,g,_,Y;return p.value.push({word:(s=n.word)!=null?s:"",desc:(g=n.desc)!=null?g:"",createAt:Q((_=n.createAt)!=null?_:""),updateAt:Q((Y=n.updateAt)!=null?Y:"")})}),$(),console.log("select",p.value))}).catch(a=>{console.log(a),e.notify({color:"red",position:"top",message:"\u30C7\u30FC\u30BF\u306E\u53D6\u5F97\u306B\u5931\u6557\u3057\u307E\u3057\u305F"})}),w.value=!1},N=function(a,c){return a.word>c.word?1:-1},$=function(){p.value.sort(N)},H=function(a){h.value=JSON.parse(JSON.stringify(a)),f.value=!0},k=i(""),oe=async function(a,c){if(k.value="",a==""&&(k.value="\u540D\u8A00\u3092\u7A7A\u306B\u306F\u3067\u304D\u306A\u3044\u3088!"),p.value.find(n=>n.word==a)&&(k.value="\u65E2\u306B\u540C\u3058\u540D\u8A00\u304C\u5B58\u5728\u3057\u3066\u308B\u3088!"),k.value==""){o.value=!0;const n={word:a,desc:c};await M.save(n).then(s=>{s&&(console.log("response",s),s.insert&&(V(),v.value.word="",v.value.desc="",e.notify({color:"blue",position:"top",message:"\u8FFD\u52A0\u5B8C\u4E86\u3057\u307E\u3057\u305F"}),$(),k.value=""))}).catch(s=>{console.log(s),e.notify({color:"red",position:"top",message:"\u30C7\u30FC\u30BF\u306E\u53D6\u5F97\u306B\u5931\u6557\u3057\u307E\u3057\u305F"})}),o.value=!1}},S=i(""),te=async function(a,c){S.value="";const n=p.value.find(s=>s.word==a);if(n||(S.value="\u66F4\u65B0\u3059\u308B\u540D\u8A00\u304C\u898B\u3064\u304B\u3089\u306A\u304B\u3063\u305F..."),(n==null?void 0:n.desc)==c&&(S.value="\u8A73\u7D30\u304C\u5909\u308F\u3063\u3066\u306A\u3044\u304B\u3089\u66F4\u65B0\u3057\u306A\u3044\u3088!"),S.value==""){o.value=!0;const s={word:a,desc:c};await M.save(s).then(g=>{g&&(console.log("response",g),g.update&&(V(),v.value.word="",v.value.desc="",e.notify({color:"blue",position:"top",message:"\u66F4\u65B0\u5B8C\u4E86\u3057\u307E\u3057\u305F"}),f.value=!1))}).catch(g=>{console.log(g),e.notify({color:"red",position:"top",message:"\u30C7\u30FC\u30BF\u306E\u53D6\u5F97\u306B\u5931\u6557\u3057\u307E\u3057\u305F"})}),o.value=!1}},O=i(!1);return{condition:b,saveModalShow:t,editModalShow:f,records:p,search:V,isLoading:w,insertCondition:v,updateRecord:te,isSaveLoading:o,deleteRecord:async function(a,c){r.value=!0;const n={word:a,desc:c};await M.delete(n).then(s=>{if(s)if(console.log("response",s),s.status){e.notify({color:"blue",position:"top",message:"\u524A\u9664\u5B8C\u4E86\u3057\u307E\u3057\u305F"});const g=p.value.findIndex(_=>_.word==a);p.value.splice(g,1),h.value={word:""},f.value=!1,O.value=!1}else e.notify({color:"red",position:"top",message:"\u30C7\u30FC\u30BF\u306E\u524A\u9664\u306B\u5931\u6557\u3057\u307E\u3057\u305F"})}).catch(s=>{console.log(s),e.notify({color:"red",position:"top",message:"\u30C7\u30FC\u30BF\u306E\u53D6\u5F97\u306B\u5931\u6557\u3057\u307E\u3057\u305F"})}),r.value=!1},isDeleteLoading:r,detailEditLock:R,updateCondition:h,onEditClick:H,insertErr:k,insertRecord:oe,updateErr:S,deleteCheckModalShow:O,columns:E}}const me=x({name:"table-word-list",props:{modelValue:{type:String,required:!0},label:{type:String,required:!1,default:"\u540D\u8A00\u96C6"},height:{type:Number,required:!1,default:700}},components:{"lock-icon":re},setup(e){const{saveModalShow:t,editModalShow:f,records:E,search:b,isLoading:v,updateRecord:h,insertCondition:w,isSaveLoading:o,deleteRecord:r,isDeleteLoading:R,detailEditLock:p,updateCondition:D,onEditClick:U,insertErr:Q,insertRecord:V,updateErr:N,deleteCheckModalShow:$,columns:H}=ce();return b(),ue(f,()=>{f.value==!1&&(D.value.word="",D.value.desc="")}),{condition:i(e.modelValue),tableName:i(e.label),tableHeight:i(e.height+"px"),editModalShow:f,records:E,search:b,isLoading:v,updateRecord:h,insertCondition:w,isSaveLoading:o,deleteRecord:r,isDeleteLoading:R,saveModalShow:t,visibleColumns:i(!0),detailEditLock:p,updateCondition:D,onEditClick:U,insertErr:Q,insertRecord:V,updateErr:N,deleteCheckModalShow:$,columns:H}}}),pe={class:"row q-gutter-md"},fe={class:"row q-gutter-md",style:{width:"800px"}},ge={style:{width:"75%"}},ve={key:3,class:"text-caption"},he={key:0,style:{width:"200px"}},we={key:1,style:{width:"100px"}},Ce=["onClick"],ye={class:"q-pa-md"},be={class:"text-subtitle1 row q-gutter-md"},Fe=l("div",{style:{"margin-right":"auto"}},"\u65B0\u898F\u8FFD\u52A0",-1),ke=l("hr",null,null,-1),Ae={class:"row q-gutter-md",style:{height:"150px"}},Be={style:{height:"150px"}},Ee=l("hr",null,null,-1),De={class:"row q-gutter-md"},Ve={class:"text-negative text-caption"},Se={class:"q-pa-md"},qe={class:"row q-gutter-md"},Le=l("div",{class:"text-h6",style:{"margin-right":"auto"}},"\u66F4\u65B0\u30FB\u524A\u9664",-1),Qe=l("hr",null,null,-1),$e={class:"row q-gutter-md",style:{height:"150px"}},_e=l("hr",null,null,-1),Me={class:"row q-gutter-md"},Re={class:"text-negative text-caption"},Ue={class:"q-pa-md"},Ne={class:"row q-gutter-md"},He=l("div",{class:"text-h6",style:{"margin-right":"auto"}},"\u524A\u9664\u78BA\u8A8D",-1),Te=l("hr",null,null,-1),Ie=l("div",null,"\u6B21\u306E\u540D\u8A00\u3092\u524A\u9664\u3057\u3066\u3082\u3044\u3044\u304B\u306A\uFF1F",-1),Pe={class:"row q-gutter-md q-pt-sm"};function We(e,t,f,E,b,v){const h=J("lock-icon"),w=J("q-section");return m(),A(P,null,[l("div",pe,[l("div",null,[u(de,{title:e.tableName,rows:e.records,columns:e.columns,"row-key":"word",style:ne({height:e.tableHeight}),separator:"cell","rows-per-page-label":"\u8868\u793A\u884C\u6570","no-results-label":"\u898B\u3064\u304B\u3089\u306A\u304B\u3063\u305F...","no-data-label":"\u898B\u3064\u304B\u3089\u306A\u304B\u3063\u305F...",pagination:{rowsPerPage:0},"rows-per-page-options":[0],filter:e.condition,class:"word-list-table"},{"top-right":d(()=>[l("div",fe,[l("div",ge,[u(L,{dense:"",debounce:"300",modelValue:e.condition,"onUpdate:modelValue":t[1]||(t[1]=o=>e.condition=o),placeholder:"\u691C\u7D22",style:{width:"200px"},align:"left"},{append:d(()=>[e.isLoading?(m(),y(ae,{key:0,modelValue:e.isLoading,"onUpdate:modelValue":t[0]||(t[0]=o=>e.isLoading=o),color:"primary",size:"md"},null,8,["modelValue"])):B("",!0),e.condition.length==0?(m(),y(T,{key:1,name:"search"})):(m(),y(T,{key:2,name:"search",color:"primary"})),e.records.length>0?(m(),A("div",ve,F(e.records.length),1)):B("",!0)]),_:1},8,["modelValue"])]),l("div",null,[u(C,{label:"\u8FFD\u52A0","icon-right":"note_add",color:"grey-6",onClick:t[2]||(t[2]=o=>e.saveModalShow=!0),outline:""})]),l("div",null,[u(h,{modelValue:e.detailEditLock,"onUpdate:modelValue":t[3]||(t[3]=o=>e.detailEditLock=o),onEventChange:t[4]||(t[4]=o=>e.detailEditLock=o),class:"q-pt-sm"},null,8,["modelValue"])])])]),header:d(o=>[u(G,{props:o},{default:d(()=>[e.detailEditLock==!1?(m(),y(K,{key:0},{default:d(()=>[I(" \u7DE8\u96C6 ")]),_:1})):B("",!0),(m(!0),A(P,null,j(o.cols,r=>(m(),y(K,{key:r.name,props:o},{default:d(()=>[r.label=="\u540D\u8A00"||r.label=="\u8A73\u7D30"?(m(),A("div",he,F(r.label),1)):B("",!0),r.label=="\u4F5C\u6210\u65E5"||r.label=="\u66F4\u65B0\u65E5"||r.label==""?(m(),A("div",we,F(r.label),1)):B("",!0)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),body:d(o=>[u(G,{props:o},{default:d(()=>[e.detailEditLock==!1?(m(),y(X,{key:0},{default:d(()=>[l("a",{href:"#",onClick:q(r=>{console.log(o.row.word),e.onEditClick(o.row)},["prevent"])},[u(T,{name:"edit_note",color:"secondary",size:"md"})],8,Ce)]),_:2},1024)):B("",!0),(m(!0),A(P,null,j(o.cols,r=>(m(),y(X,{key:r.name,props:o,style:{"text-align":"left","white-space":"pre-wrap","word-wrap":"break-word"}},{default:d(()=>[I(F(r.value),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),_:1},8,["title","rows","columns","style","filter"])]),u(z,{modelValue:e.saveModalShow,"onUpdate:modelValue":t[9]||(t[9]=o=>e.saveModalShow=o)},{default:d(()=>[u(W,{style:{"max-width":"800px"}},{default:d(()=>[u(Z,null,{default:d(()=>[l("div",ye,[l("div",be,[Fe,u(C,{icon:"close",onClick:t[5]||(t[5]=o=>e.saveModalShow=!1),round:"",flat:""})]),ke,l("div",Ae,[l("div",Be,[u(L,{label:"\u540D\u8A00",type:"textarea",modelValue:e.insertCondition.word,"onUpdate:modelValue":t[6]||(t[6]=o=>e.insertCondition.word=o),class:"form-model",dense:"",outlined:"","stack-label":"",style:{width:"250px"},clearable:""},null,8,["modelValue"])]),u(L,{label:"\u8A73\u7D30(\u7701\u7565\u53EF)",type:"textarea",modelValue:e.insertCondition.desc,"onUpdate:modelValue":t[7]||(t[7]=o=>e.insertCondition.desc=o),class:"form-model",dense:"",outlined:"","stack-label":"",style:{width:"400px"},clearable:""},null,8,["modelValue"])]),Ee,l("div",De,[u(C,{onClick:t[8]||(t[8]=q(o=>e.insertRecord(e.insertCondition.word,e.insertCondition.desc),["prevent"])),label:"\u8FFD\u52A0",color:"primary",outline:"",icon:"note_add",loading:e.isSaveLoading},null,8,["loading"])]),l("div",Ve,F(e.insertErr),1)])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),u(z,{modelValue:e.editModalShow,"onUpdate:modelValue":t[15]||(t[15]=o=>e.editModalShow=o)},{default:d(()=>[u(W,{style:{"max-width":"800px"}},{default:d(()=>[u(Z,null,{default:d(()=>[l("div",Se,[l("div",qe,[Le,u(C,{icon:"close",onClick:t[10]||(t[10]=o=>e.editModalShow=!1),round:"",flat:""})]),Qe,l("div",$e,[u(L,{label:"\u540D\u8A00",type:"textarea",modelValue:e.updateCondition.word,"onUpdate:modelValue":t[11]||(t[11]=o=>e.updateCondition.word=o),class:"form-model",dense:"",outlined:"","stack-label":"",style:{width:"250px"},readonly:""},null,8,["modelValue"]),u(L,{label:"\u8A73\u7D30(\u7701\u7565\u53EF)",type:"textarea",modelValue:e.updateCondition.desc,"onUpdate:modelValue":t[12]||(t[12]=o=>e.updateCondition.desc=o),class:"form-model",dense:"",outlined:"","stack-label":"",style:{width:"400px"},clearable:""},null,8,["modelValue"])]),_e,l("div",Me,[u(C,{onClick:t[13]||(t[13]=q(o=>e.updateRecord(e.updateCondition.word,e.updateCondition.desc),["prevent"])),label:"\u66F4\u65B0",color:"primary",outline:"",icon:"note_add",style:{"margin-right":"auto"},loading:e.isSaveLoading},null,8,["loading"]),l("div",Re,F(e.updateErr),1),u(C,{onClick:t[14]||(t[14]=q(o=>e.deleteCheckModalShow=!0,["prevent"])),label:"\u524A\u9664",color:"negative",outline:"",icon:"note_add"})])])]),_:1})]),_:1})]),_:1},8,["modelValue"]),u(z,{modelValue:e.deleteCheckModalShow,"onUpdate:modelValue":t[18]||(t[18]=o=>e.deleteCheckModalShow=o)},{default:d(()=>[u(W,null,{default:d(()=>[u(w,null,{default:d(()=>[l("div",Ue,[l("div",Ne,[He,u(C,{icon:"close",onClick:t[16]||(t[16]=o=>e.deleteCheckModalShow=!1),round:"",flat:""})]),Te,Ie,u(ie,{label:"\u540D\u8A00","stack-label":""},{default:d(()=>[I(F(e.updateCondition.word),1)]),_:1}),l("div",Pe,[u(C,{onClick:t[17]||(t[17]=q(o=>e.deleteRecord(e.updateCondition.word,e.updateCondition.desc),["prevent"])),label:"\u524A\u9664\u3059\u308B",color:"negative",outline:"",icon:"note_add",dense:"",loading:e.isDeleteLoading},null,8,["loading"])])])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}var ze=ee(me,[["render",We]]);const Je=x({name:"word-list",components:{"word-list-table":ze},setup(){const e=i(document.documentElement.scrollHeight*.85);return{filter:i(""),pageHeight:e}}});function Oe(e,t,f,E,b,v){const h=J("word-list-table");return m(),y(le,{class:""},{default:d(()=>[u(h,{modelValue:e.filter,"onUpdate:modelValue":t[0]||(t[0]=w=>e.filter=w),height:e.pageHeight},null,8,["modelValue","height"])]),_:1})}var yo=ee(Je,[["render",Oe]]);export{yo as default};
