import{Q as ue}from"./QPage.82e76fcb.js";import{r as n,d as W,k as U,_ as G,o as f,c as w,w as s,ae as M,g as S,ad as L,ah as ee,a as _,aa as A,b as l,e as u,ac as ae,ab as D,Q as B,f as H,af as O,ag as K}from"./index.14a7c722.js";import{u as ie,Q as z}from"./use-quasar.7a6bd282.js";import{Q as X,a as Z,b as x,c as ne}from"./QTable.8542a644.js";import{Q as j}from"./QCard.856b109b.js";import{Q as J}from"./QDialog.946db96e.js";import{Q as oe}from"./QSelect.c55664e6.js";import{Q as se}from"./QField.3dd07fc9.js";import{A as de}from"./BaseApi.ab9ec937.js";import{l as re}from"./LockIcon.df8f6aff.js";import"./focus-manager.02955f48.js";import"./QSeparator.2e92d9dc.js";import"./use-dark.7ce8ffd6.js";import"./QList.0b3bac39.js";import"./use-prevent-scroll.49273e16.js";import"./QCheckbox.9468544f.js";import"./use-checkbox.812d2cd3.js";import"./use-tick.7b8fea28.js";import"./QChip.15935488.js";import"./QItem.0cb08ef4.js";import"./QItemLabel.d7165eea.js";import"./position-engine.ef89f240.js";import"./format.2a3572e1.js";class pe extends de{search(o){const p="/yakiList/search",m=this.combineUrl(p);return this.httpPost(m,o)}save(o){const p="/yakiList/save",m=this.combineUrl(p);return this.httpPost(m,o)}delete(o){const p="/yakiList/delete",m=this.combineUrl(p);return this.httpPost(m,o)}}const Q=new pe;function me(){const e=ie(),o=n(!1),p=n(!1),m=["\u713C\u304D\u76F4\u3057","\u713C\u304D\u76F4\u3057\u30D5\u30A7\u30CB\u30C3\u30AF\u30B9"],y=[{name:"word",label:"\u6761\u7D04",field:"word",sortable:!0},{name:"yaki",label:"\u7A2E\u985E",field:"yaki",sortable:!0}],C=n({word:"",yaki:""}),g=n({word:"",yaki:"\u713C\u304D\u76F4\u3057"}),b=n({word:"",yaki:""}),F=n(!1),t=n(!1),c=n(!1),R=n(!0),v=n([]),q=async function(){F.value=!0,await Q.search({text:C.value.word}).then(a=>{var d;a&&(console.log("response",a),v.value.splice(0),(d=a.records)==null||d.forEach(r=>{var i,k;return v.value.push({word:(i=r.word)!=null?i:"",yaki:(k=r.yaki)!=null?k:""})}),$(),C.value.word=="\u713C\u304D\u76F4\u3057"&&(v.value=v.value.filter(r=>r.yaki=="\u713C\u304D\u76F4\u3057")))}).catch(a=>{console.log(a),e.notify({color:"red",position:"top",message:"\u30C7\u30FC\u30BF\u306E\u53D6\u5F97\u306B\u5931\u6557\u3057\u307E\u3057\u305F"})}),F.value=!1},N=function(a,d){return a.word>d.word?1:-1},$=function(){v.value.sort(N)},P=function(a){b.value=JSON.parse(JSON.stringify(a)),p.value=!0},V=n(""),T=async function(a,d){if(V.value="",a==""&&(V.value="\u6761\u7D04\u3092\u7A7A\u306B\u306F\u3067\u304D\u306A\u3044\u3088!"),v.value.find(r=>r.word==a)&&(V.value="\u65E2\u306B\u540C\u3058\u6761\u7D04\u304C\u5B58\u5728\u3057\u3066\u308B\u3088!"),V.value==""){t.value=!0;const r={word:a.replace(/\n/g,""),yaki:d.replace(/\n/g,"")};await Q.save(r).then(i=>{i&&(console.log("response",i),i.insert&&(v.value.push({word:a,yaki:d}),g.value.word="",e.notify({color:"blue",position:"top",message:"\u8FFD\u52A0\u5B8C\u4E86\u3057\u307E\u3057\u305F"}),$(),V.value=""))}).catch(i=>{console.log(i),e.notify({color:"red",position:"top",message:"\u30C7\u30FC\u30BF\u306E\u53D6\u5F97\u306B\u5931\u6557\u3057\u307E\u3057\u305F"})}),t.value=!1}},E=n(""),Y=async function(a,d){E.value="";const r=v.value.find(i=>i.word==a);if(r||(E.value="\u66F4\u65B0\u3059\u308B\u6761\u7D04\u304C\u898B\u3064\u304B\u3089\u306A\u304B\u3063\u305F..."),(r==null?void 0:r.yaki)==d&&(E.value="\u8A73\u7D30\u304C\u5909\u308F\u3063\u3066\u306A\u3044\u304B\u3089\u66F4\u65B0\u3057\u306A\u3044\u3088!"),E.value==""){t.value=!0;const i={word:a.replace(/\n/g,""),yaki:d.replace(/\n/g,"")};await Q.save(i).then(k=>{if(k&&(console.log("response",k),k.update)){const I=v.value.findIndex(le=>le.word==a);v.value[I]={word:a,yaki:d},g.value.word="",g.value.yaki="",e.notify({color:"blue",position:"top",message:"\u66F4\u65B0\u5B8C\u4E86\u3057\u307E\u3057\u305F"}),p.value=!1}}).catch(k=>{console.log(k),e.notify({color:"red",position:"top",message:"\u30C7\u30FC\u30BF\u306E\u53D6\u5F97\u306B\u5931\u6557\u3057\u307E\u3057\u305F"})}),t.value=!1}},h=n(!1);return{condition:C,saveModalShow:o,editModalShow:p,records:v,search:q,isLoading:F,insertCondition:g,updateRecord:Y,isSaveLoading:t,deleteRecord:async function(a,d){c.value=!0;const r={word:a.replace(/\n/g,""),yaki:d.replace(/\n/g,"")};await Q.delete(r).then(i=>{if(i)if(console.log("response",i),i.status){e.notify({color:"blue",position:"top",message:"\u524A\u9664\u5B8C\u4E86\u3057\u307E\u3057\u305F"});const k=v.value.findIndex(I=>I.word==a);v.value.splice(k,1),b.value={word:""},p.value=!1,h.value=!1}else e.notify({color:"red",position:"top",message:"\u30C7\u30FC\u30BF\u306E\u524A\u9664\u306B\u5931\u6557\u3057\u307E\u3057\u305F"})}).catch(i=>{console.log(i),e.notify({color:"red",position:"top",message:"\u30C7\u30FC\u30BF\u306E\u53D6\u5F97\u306B\u5931\u6557\u3057\u307E\u3057\u305F"})}),c.value=!1},isDeleteLoading:c,detailEditLock:R,updateCondition:b,onEditClick:P,insertErr:V,insertRecord:T,updateErr:E,deleteCheckModalShow:h,selecter:m,columns:y}}const ce=W({name:"yaki-select",props:{modelValue:{type:String,required:!0},label:{type:String,required:!1,default:"\u713C\u304D\u76F4\u3057\u7A2E\u985E"},width:{type:Number,required:!1,default:200}},setup(e,{emit:o}){const p=n(["\u713C\u304D\u76F4\u3057","\u713C\u304D\u76F4\u3057\u30D5\u30A7\u30CB\u30C3\u30AF\u30B9"]);U(p,y=>{y.includes(e.modelValue)||(m.value="")});const m=n(e.modelValue);return U(m,y=>{o("update:modelValue",y)}),{selectedValue:m,selectLabel:n(e.label),selectWidth:n(e.width),selectOptions:p}}});function fe(e,o,p,m,y,C){return f(),w(oe,{modelValue:e.selectedValue,"onUpdate:modelValue":o[1]||(o[1]=g=>e.selectedValue=g),options:e.selectOptions,dense:"","stack-label":"",label:e.selectLabel,style:ee({width:e.selectWidth+"px"}),"transition-show":"jump-up","transition-hide":"jump-up"},{append:s(()=>[e.selectedValue!=""?(f(),w(M,{key:0,id:"yaki-select-clear-icon",name:"clear",onClick:o[0]||(o[0]=S(g=>e.selectedValue="",["stop","prevent"]))})):L("",!0)]),_:1},8,["modelValue","options","label","style"])}var ve=G(ce,[["render",fe]]);const ge=W({name:"table-yaki-list",components:{"lock-icon":re,"yaki-select":ve},props:{modelValue:{type:String,required:!0},label:{type:String,required:!1,default:"\u713C\u304D\u76F4\u3057\u6761\u7D04"},height:{type:Number,required:!1,default:700}},setup(e){const{condition:o,saveModalShow:p,editModalShow:m,records:y,search:C,isLoading:g,updateRecord:b,insertCondition:F,isSaveLoading:t,deleteRecord:c,isDeleteLoading:R,detailEditLock:v,updateCondition:q,onEditClick:N,insertErr:$,insertRecord:P,updateErr:V,deleteCheckModalShow:T,selecter:E,columns:Y}=me();C(),U(m,()=>{m.value==!1&&(q.value.word="")}),U(o.value,()=>{o.value.yaki&&o.value.yaki!=""&&(o.value.word=o.value.yaki,o.value.yaki="")});const h=n({word:e.modelValue,yaki:""});return{filterCondition:h,filteringData:function(a){let d=a;return h.value.word!=""&&h.value.word!=null&&(d=d.filter(r=>{var i;return r.word.includes((i=h.value.word)!=null?i:"")})),h.value.yaki!=""&&h.value.yaki!=null&&(d=d.filter(r=>{var i;return r.yaki==((i=h.value.yaki)!=null?i:"")})),console.log("filter",d),d},tableName:n(e.label),tableHeight:n(e.height+"px"),condition:o,editModalShow:m,records:y,search:C,isLoading:g,updateRecord:b,insertCondition:F,isSaveLoading:t,deleteRecord:c,isDeleteLoading:R,saveModalShow:p,visibleColumns:n(!0),detailEditLock:v,updateCondition:q,onEditClick:N,insertErr:$,insertRecord:P,updateErr:V,deleteCheckModalShow:T,selecter:E,columns:Y}}}),ye={class:"row q-gutter-md",style:{width:"800px"}},he={style:{width:"75%"},class:"row q-gutter-md"},ke={key:3,class:"text-caption"},we={class:"row q-gutter-md"},Ce={key:0,style:{width:"200px"}},be={key:1,style:{width:"100px"}},Fe=["onClick"],Ve={class:"q-pa-md"},Be={class:"text-subtitle1 row q-gutter-md"},Ee=u("div",{style:{"margin-right":"auto"}},"\u65B0\u898F\u8FFD\u52A0",-1),De=u("hr",null,null,-1),Ae={class:"row q-gutter-md",style:{height:"150px"}},Se={style:{height:"150px"}},Le=u("hr",null,null,-1),qe={class:"row q-gutter-md"},$e={class:"text-negative text-caption"},Qe={class:"q-pa-md"},Me={class:"row q-gutter-md"},_e=u("div",{class:"text-h6",style:{"margin-right":"auto"}},"\u66F4\u65B0\u30FB\u524A\u9664",-1),Ue=u("hr",null,null,-1),Re={class:"row q-gutter-md",style:{height:"150px"}},Ne=u("hr",null,null,-1),Pe={class:"row q-gutter-md"},Te={class:"text-negative text-caption"},Ye={class:"q-pa-md"},Ie={class:"row q-gutter-md"},He=u("div",{class:"text-h6",style:{"margin-right":"auto"}},"\u524A\u9664\u78BA\u8A8D",-1),Oe=u("hr",null,null,-1),ze=u("div",null,"\u6B21\u306E\u6761\u7D04\u3092\u524A\u9664\u3057\u3066\u3082\u3044\u3044\u304B\u306A\uFF1F",-1),je={class:"row q-gutter-md q-pt-sm"};function Je(e,o,p,m,y,C){const g=_("yaki-select"),b=_("lock-icon"),F=_("q-section");return f(),A(O,null,[l(ne,{title:e.tableName,rows:e.records,columns:e.columns,"row-key":"word",style:ee({height:e.tableHeight}),separator:"cell","rows-per-page-label":"\u8868\u793A\u884C\u6570","no-results-label":"\u898B\u3064\u304B\u3089\u306A\u304B\u3063\u305F...","no-data-label":"\u898B\u3064\u304B\u3089\u306A\u304B\u3063\u305F...",pagination:{rowsPerPage:0},"rows-per-page-options":[0],filter:e.filterCondition,"filter-method":e.filteringData,class:"yaki-list-table"},{"top-right":s(()=>[u("div",ye,[u("div",he,[l(z,{dense:"",debounce:"300",modelValue:e.filterCondition.word,"onUpdate:modelValue":o[1]||(o[1]=t=>e.filterCondition.word=t),placeholder:"\u691C\u7D22",style:{width:"200px"},align:"left"},{append:s(()=>{var t;return[e.isLoading?(f(),w(ae,{key:0,modelValue:e.isLoading,"onUpdate:modelValue":o[0]||(o[0]=c=>e.isLoading=c),color:"primary",size:"md"},null,8,["modelValue"])):L("",!0),((t=e.filterCondition.word)!=null?t:"").length==0||e.filterCondition.word==null?(f(),w(M,{key:1,name:"search"})):(f(),w(M,{key:2,name:"search",color:"primary"})),e.records.length>0?(f(),A("div",ke,D(e.records.length),1)):L("",!0)]}),_:1},8,["modelValue"]),l(g,{modelValue:e.filterCondition.yaki,"onUpdate:modelValue":o[2]||(o[2]=t=>e.filterCondition.yaki=t)},null,8,["modelValue"])]),u("div",we,[u("div",null,[l(B,{label:"\u8FFD\u52A0","icon-right":"note_add",color:"grey-6",onClick:o[3]||(o[3]=t=>e.saveModalShow=!0),outline:""})]),u("div",null,[l(b,{modelValue:e.detailEditLock,"onUpdate:modelValue":o[4]||(o[4]=t=>e.detailEditLock=t),onEventChange:o[5]||(o[5]=t=>e.detailEditLock=t),class:"q-pt-sm"},null,8,["modelValue"])])])])]),header:s(t=>[l(X,{props:t},{default:s(()=>[e.detailEditLock==!1?(f(),w(Z,{key:0},{default:s(()=>[H(" \u7DE8\u96C6 ")]),_:1})):L("",!0),(f(!0),A(O,null,K(t.cols,c=>(f(),w(Z,{key:c.name,props:t},{default:s(()=>[c.label=="\u6761\u7D04"?(f(),A("div",Ce,D(c.label),1)):(f(),A("div",be,D(c.label),1))]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),body:s(t=>[l(X,{props:t},{default:s(()=>[e.detailEditLock==!1?(f(),w(x,{key:0},{default:s(()=>[u("a",{href:"#",onClick:S(c=>{console.log(t.row.word),e.onEditClick(t.row)},["prevent"])},[l(M,{name:"edit_note",color:"secondary",size:"md"})],8,Fe)]),_:2},1024)):L("",!0),(f(!0),A(O,null,K(t.cols,c=>(f(),w(x,{key:c.name,props:t,style:{"white-space":"normal","text-align":"left"}},{default:s(()=>[H(D(c.value),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),_:1},8,["title","rows","columns","style","filter","filter-method"]),l(J,{modelValue:e.saveModalShow,"onUpdate:modelValue":o[10]||(o[10]=t=>e.saveModalShow=t)},{default:s(()=>[l(j,null,{default:s(()=>[l(F,null,{default:s(()=>[u("div",Ve,[u("div",Be,[Ee,l(B,{icon:"close",onClick:o[6]||(o[6]=t=>e.saveModalShow=!1),round:"",flat:""})]),De,u("div",Ae,[u("div",Se,[l(z,{label:"\u6761\u7D04\u540D",type:"textarea",modelValue:e.insertCondition.word,"onUpdate:modelValue":o[7]||(o[7]=t=>e.insertCondition.word=t),class:"form-model",dense:"",outlined:"","stack-label":"",style:{width:"250px"},clearable:""},null,8,["modelValue"])]),l(g,{modelValue:e.insertCondition.yaki,"onUpdate:modelValue":o[8]||(o[8]=t=>e.insertCondition.yaki=t)},null,8,["modelValue"])]),Le,u("div",qe,[l(B,{onClick:o[9]||(o[9]=S(t=>e.insertRecord(e.insertCondition.word,e.insertCondition.yaki),["prevent"])),label:"\u8FFD\u52A0",color:"primary",outline:"",icon:"note_add",loading:e.isSaveLoading,disable:e.insertCondition.word==""||e.insertCondition.yaki==""},null,8,["loading","disable"])]),u("div",$e,D(e.insertErr),1)])]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(J,{modelValue:e.editModalShow,"onUpdate:modelValue":o[16]||(o[16]=t=>e.editModalShow=t)},{default:s(()=>[l(j,null,{default:s(()=>[l(F,null,{default:s(()=>[u("div",Qe,[u("div",Me,[_e,l(B,{icon:"close",onClick:o[11]||(o[11]=t=>e.editModalShow=!1),round:"",flat:""})]),Ue,u("div",Re,[l(z,{label:"\u6761\u7D04",type:"textarea",modelValue:e.updateCondition.word,"onUpdate:modelValue":o[12]||(o[12]=t=>e.updateCondition.word=t),class:"form-model",dense:"",outlined:"","stack-label":"",style:{width:"250px"},readonly:""},null,8,["modelValue"]),l(oe,{label:"\u7A2E\u985E",options:e.selecter,modelValue:e.updateCondition.yaki,"onUpdate:modelValue":o[13]||(o[13]=t=>e.updateCondition.yaki=t),class:"form-model",dense:"","stack-label":"",style:{width:"250px"}},null,8,["options","modelValue"])]),Ne,u("div",Pe,[l(B,{onClick:o[14]||(o[14]=S(t=>e.updateRecord(e.updateCondition.word,e.updateCondition.yaki),["prevent"])),label:"\u66F4\u65B0",color:"primary",outline:"",icon:"note_add",style:{"margin-right":"auto"},loading:e.isSaveLoading},null,8,["loading"]),u("div",Te,D(e.updateErr),1),l(B,{onClick:o[15]||(o[15]=S(t=>e.deleteCheckModalShow=!0,["prevent"])),label:"\u524A\u9664",color:"negative",outline:"",icon:"note_add"})])])]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(J,{modelValue:e.deleteCheckModalShow,"onUpdate:modelValue":o[19]||(o[19]=t=>e.deleteCheckModalShow=t)},{default:s(()=>[l(j,null,{default:s(()=>[l(F,null,{default:s(()=>[u("div",Ye,[u("div",Ie,[He,l(B,{icon:"close",onClick:o[17]||(o[17]=t=>e.deleteCheckModalShow=!1),round:"",flat:""})]),Oe,ze,l(se,{label:"\u6761\u7D04","stack-label":""},{default:s(()=>[H(D(e.updateCondition.word),1)]),_:1}),u("div",je,[l(B,{onClick:o[18]||(o[18]=S(t=>e.deleteRecord(e.updateCondition.word,e.updateCondition.yaki),["prevent"])),label:"\u524A\u9664\u3059\u308B",color:"negative",outline:"",icon:"note_add",dense:"",loading:e.isDeleteLoading},null,8,["loading"])])])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}var We=G(ge,[["render",Je]]);const Ge=W({name:"yaki-list",components:{"table-yaki-list":We},setup(){const e=n(document.documentElement.scrollHeight*.85);return{filter:n(""),pageHeight:e}}});function Ke(e,o,p,m,y,C){const g=_("table-yaki-list");return f(),w(ue,{class:""},{default:s(()=>[l(g,{modelValue:e.filter,"onUpdate:modelValue":o[0]||(o[0]=b=>e.filter=b),height:e.pageHeight},null,8,["modelValue","height"])]),_:1})}var Co=G(Ge,[["render",Ke]]);export{Co as default};
