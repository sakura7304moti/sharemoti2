import{Q as ne}from"./QPage.82e76fcb.js";import{r as m,d as te,k as x,_ as ue,a as T,o as v,aa as f,e as t,b as u,w as r,c as V,ac as ie,ad as L,ae as j,ab as E,Q as D,f as G,af as Q,ag as U,g as M,ah as se}from"./index.14a7c722.js";import{u as de,Q as _}from"./use-quasar.7a6bd282.js";import{Q as ee,a as le,b as oe,c as re}from"./QTable.8542a644.js";import{Q as me}from"./QCardSection.d3461790.js";import{Q as K}from"./QCard.856b109b.js";import{Q as W}from"./QDialog.946db96e.js";import{Q as ve}from"./QField.3dd07fc9.js";import{a as $,S as pe}from"./SsbuNameSelect.4d0a056a.js";import{l as fe}from"./LockIcon.df8f6aff.js";import"./BaseApi.ab9ec937.js";import"./use-dark.7ce8ffd6.js";import"./focus-manager.02955f48.js";import"./QSeparator.2e92d9dc.js";import"./QList.0b3bac39.js";import"./QSelect.c55664e6.js";import"./QChip.15935488.js";import"./QItem.0cb08ef4.js";import"./QItemLabel.d7165eea.js";import"./position-engine.ef89f240.js";import"./use-tick.7b8fea28.js";import"./use-prevent-scroll.49273e16.js";import"./format.2a3572e1.js";import"./QCheckbox.9468544f.js";import"./use-checkbox.812d2cd3.js";function ce(){const e=de(),o=m(!1),y=m(!1),C=m({key:"",val:""}),b=m({key:"",val:""}),F=m({key:"",val:""}),h=m(!1),c=m(!1),k=m(!1),l=m(!0),n=m([]),H=[{name:"key",label:"\u3042\u3060\u540D",field:"key",sortable:!0},{name:"val",label:"\u30AD\u30E3\u30E9\u540D",field:"val",sortable:!0}],I=async function(){var i;h.value=!0;const a={key:C.value.key,val:(i=C.value.val)!=null?i:""};await $.search(a).then(s=>{var d;s&&(console.log("response",s),n.value.splice(0),(d=s.records)==null||d.forEach(p=>{var A,N,Y,Z;p.val!="\u305D\u306E\u4ED6"&&n.value.push({id:((A=p.key)!=null?A:"")+((N=p.val)!=null?N:""),key:(Y=p.key)!=null?Y:"",val:(Z=p.val)!=null?Z:""})}),R())}).catch(s=>{console.log(s),e.notify({color:"red",position:"top",message:"\u30C7\u30FC\u30BF\u306E\u53D6\u5F97\u306B\u5931\u6557\u3057\u307E\u3057\u305F"})}),h.value=!1},S=m([]),J=function(a,i){return a.val>i.val?1:-1},R=function(){n.value.sort(J)},O=function(a){F.value=JSON.parse(JSON.stringify(a)),w.value=JSON.parse(JSON.stringify(a)),y.value=!0},B=m(""),P=async function(a,i){if(B.value="",a==""&&(B.value="\u3042\u3060\u540D\u3092\u7A7A\u306B\u306F\u3067\u304D\u306A\u3044\u3088!"),n.value.find(s=>s.key==a)&&(B.value="\u65E2\u306B\u540C\u3058\u3042\u3060\u540D\u304C\u5B58\u5728\u3057\u3066\u308B\u3088!"),B.value==""){c.value=!0;const s={key:a.replace(/\n/g,""),val:i.replace(/\n/g,"")};await $.insert(s).then(d=>{d&&(console.log("response",d),d.insert&&(n.value.push({id:a+i,key:a,val:i}),S.value.push({id:a+i,key:a,val:i}),b.value.key="",b.value.val="",e.notify({color:"blue",position:"top",message:"\u8FFD\u52A0\u5B8C\u4E86\u3057\u307E\u3057\u305F"}),R(),B.value=""))}).catch(d=>{console.log(d),e.notify({color:"red",position:"top",message:"\u30C7\u30FC\u30BF\u306E\u53D6\u5F97\u306B\u5931\u6557\u3057\u307E\u3057\u305F"})}),c.value=!1}},q=m(""),w=m({key:"",val:""}),z=async function(a,i){q.value="";const s=n.value.find(d=>d.val==i);if(s||(q.value="\u66F4\u65B0\u3059\u308B\u3042\u3060\u540D\u304C\u898B\u3064\u304B\u3089\u306A\u304B\u3063\u305F..."),(s==null?void 0:s.key)==a&&(q.value="\u30AD\u30E3\u30E9\u540D\u304C\u5909\u308F\u3063\u3066\u306A\u3044\u304B\u3089\u66F4\u65B0\u3057\u306A\u3044\u3088!"),q.value==""){c.value=!0;const d={bkey:w.value.key.replace(/\n/g,""),bval:w.value.val.replace(/\n/g,""),key:a.replace(/\n/g,""),val:i.replace(/\n/g,"")};console.log("update c",d),await $.update(d).then(p=>{if(p&&(console.log("response",p),p.update)){const A=n.value.findIndex(N=>N.key==w.value.key&&N.val==w.value.val);n.value[A]={id:a+i,key:a,val:i},b.value.key="",b.value.val="",e.notify({color:"blue",position:"top",message:"\u66F4\u65B0\u5B8C\u4E86\u3057\u307E\u3057\u305F"}),y.value=!1}}).catch(p=>{console.log(p),e.notify({color:"red",position:"top",message:"\u30C7\u30FC\u30BF\u306E\u53D6\u5F97\u306B\u5931\u6557\u3057\u307E\u3057\u305F"})}),c.value=!1}},g=m(!1);return{condition:C,saveModalShow:o,editModalShow:y,records:n,search:I,saveDisplayList:S,isLoading:h,insertCondition:b,updateRecord:z,isSaveLoading:c,deleteRecord:async function(a,i){k.value=!0;const s={key:a.replace(/\n/g,""),val:i.replace(/\n/g,"")};await $.delete(s).then(d=>{if(d)if(console.log("response",d),d.status){e.notify({color:"blue",position:"top",message:"\u524A\u9664\u5B8C\u4E86\u3057\u307E\u3057\u305F"});const p=n.value.findIndex(A=>A.key==a);n.value.splice(p,1),F.value={key:""},y.value=!1,g.value=!1}else e.notify({color:"red",position:"top",message:"\u30C7\u30FC\u30BF\u306E\u524A\u9664\u306B\u5931\u6557\u3057\u307E\u3057\u305F"})}).catch(d=>{console.log(d),e.notify({color:"red",position:"top",message:"\u30C7\u30FC\u30BF\u306E\u53D6\u5F97\u306B\u5931\u6557\u3057\u307E\u3057\u305F"})}),k.value=!1},isDeleteLoading:k,detailEditLock:l,updateCondition:F,onEditClick:O,insertErr:B,insertRecord:P,updateErr:q,deleteCheckModalShow:g,initNameList:async function(){await $.init()},updateBeforeCondition:w,columns:H}}const ge=te({name:"name-list",props:{modelValue:{type:String,required:!0},label:{type:String,required:!1,default:"\u3042\u3060\u540D\u4E00\u89A7"},height:{type:Number,required:!1,default:700}},components:{"lock-icon":fe,"ssbu-name-select":pe},setup(e){const{condition:o,saveModalShow:y,editModalShow:C,records:b,search:F,isLoading:h,updateRecord:c,insertCondition:k,isSaveLoading:l,deleteRecord:n,isDeleteLoading:H,detailEditLock:I,updateCondition:S,onEditClick:J,insertErr:R,insertRecord:O,updateErr:B,deleteCheckModalShow:P,columns:q,saveDisplayList:w,updateBeforeCondition:z}=ce();F(),x(C,()=>{C.value==!1&&(S.value.key="",S.value.val="")}),x(y,()=>{y.value==!1&&(k.value.key="",k.value.val="",w.value.splice(0))});const g=m({query:e.modelValue,charName:""});return{filterCondition:g,filteringData:function(X){let a=X;return g.value.query!=""&&g.value.query!=null&&(a=a.filter(i=>{var s,d;return i.key.includes((s=g.value.query)!=null?s:"")||i.val.includes((d=g.value.query)!=null?d:"")})),g.value.charName!=""&&g.value.charName!=null&&(a=a.filter(i=>{var s;return i.val==((s=g.value.charName)!=null?s:"")})),console.log("filter",a),a},tableName:m(e.label),tableHeight:m(e.height+"px"),condition:o,editModalShow:C,records:b,search:F,isLoading:h,updateRecord:c,insertCondition:k,isSaveLoading:l,deleteRecord:n,isDeleteLoading:H,saveModalShow:y,visibleColumns:m(!0),detailEditLock:I,columns:q,updateCondition:S,onEditClick:J,insertErr:R,insertRecord:O,updateErr:B,deleteCheckModalShow:P,saveDisplayList:w,updateBeforeCondition:z}}}),ye={class:"row q-gutter-md"},he={class:"row q-gutter-md",style:{width:"800px"}},ke={style:{width:"65%"},class:"row q-gutter-md"},Ce={key:3,class:"text-caption"},be={class:"row q-gutter-md"},we={key:0,style:{width:"200px"}},Ee={key:1,style:{width:"100px"}},Fe=["onClick"],Be={class:"text-subtitle1 row q-gutter-md"},De=t("div",{class:"text-h5",style:{"margin-right":"auto"}},"\u65B0\u898F\u8FFD\u52A0",-1),Ve={class:"row q-gutter-md q-pa-md q-pb-lg"},qe={key:0},Se=t("div",{class:"text-subtitle1"},"\u8FFD\u52A0\u6E08",-1),Ae={class:"row q-gutter-md q-pt-md"},Le={class:"text-negative text-caption"},Ne={class:"q-pa-md"},Qe={class:"row q-gutter-md"},Me=t("div",{class:"text-h6",style:{"margin-right":"auto"}},"\u66F4\u65B0\u30FB\u524A\u9664",-1),$e=t("hr",null,null,-1),Re={class:"row q-gutter-md"},Ue={key:0},_e=t("div",{class:"text-h6"},"\u767B\u9332\u6E08\u307F\u306E\u3042\u3060\u540D",-1),Te=t("hr",null,null,-1),He={class:"row q-gutter-md"},Ie={class:"text-negative text-caption"},Je={class:"q-pa-md"},Oe={class:"row q-gutter-md"},Pe=t("div",{class:"text-h6",style:{"margin-right":"auto"}},"\u524A\u9664\u78BA\u8A8D",-1),ze=t("hr",null,null,-1),je=t("div",null,"\u6B21\u306E\u3042\u3060\u540D\u3092\u524A\u9664\u3057\u3066\u3082\u3044\u3044\u304B\u306A\uFF1F",-1),Ge={class:"row q-gutter-md q-pt-sm"};function Ke(e,o,y,C,b,F){const h=T("ssbu-name-select"),c=T("lock-icon"),k=T("q-section");return v(),f(Q,null,[t("div",ye,[t("div",null,[u(re,{title:e.tableName,rows:e.records,columns:e.columns,"row-key":"id",style:se({height:e.tableHeight}),separator:"cell","rows-per-page-label":"\u8868\u793A\u884C\u6570","no-results-label":"\u898B\u3064\u304B\u3089\u306A\u304B\u3063\u305F...","no-data-label":"\u898B\u3064\u304B\u3089\u306A\u304B\u3063\u305F...",pagination:{rowsPerPage:0},"rows-per-page-options":[0],filter:e.filterCondition,"filter-method":e.filteringData,class:"name-list-table"},{"top-right":r(()=>[t("div",he,[t("div",ke,[u(_,{dense:"",debounce:"300",modelValue:e.filterCondition.query,"onUpdate:modelValue":o[1]||(o[1]=l=>e.filterCondition.query=l),placeholder:"\u691C\u7D22",style:{width:"200px"},align:"left"},{append:r(()=>{var l;return[e.isLoading?(v(),V(ie,{key:0,modelValue:e.isLoading,"onUpdate:modelValue":o[0]||(o[0]=n=>e.isLoading=n),color:"primary",size:"md"},null,8,["modelValue"])):L("",!0),((l=e.filterCondition.query)!=null?l:"").length==0||e.filterCondition.query==null?(v(),V(j,{key:1,name:"search"})):(v(),V(j,{key:2,name:"search",color:"primary"})),e.records.length?(v(),f("div",Ce,E(e.records.length),1)):L("",!0)]}),_:1},8,["modelValue"]),u(h,{modelValue:e.filterCondition.charName,"onUpdate:modelValue":o[2]||(o[2]=l=>e.filterCondition.charName=l)},null,8,["modelValue"])]),t("div",be,[t("div",null,[u(D,{label:"\u8FFD\u52A0","icon-right":"note_add",color:"grey-6",onClick:o[3]||(o[3]=l=>e.saveModalShow=!0),outline:""})]),t("div",null,[u(c,{modelValue:e.detailEditLock,"onUpdate:modelValue":o[4]||(o[4]=l=>e.detailEditLock=l),onEventChange:o[5]||(o[5]=l=>e.detailEditLock=l),class:"q-pt-sm"},null,8,["modelValue"])])])])]),header:r(l=>[u(ee,{props:l},{default:r(()=>[e.detailEditLock==!1?(v(),V(le,{key:0},{default:r(()=>[G(" \u7DE8\u96C6 ")]),_:1})):L("",!0),(v(!0),f(Q,null,U(l.cols,n=>(v(),V(le,{key:n.name,props:l},{default:r(()=>[n.label=="\u3042\u3060\u540D"||n.label=="\u30AD\u30E3\u30E9\u540D"?(v(),f("div",we,E(n.label),1)):(v(),f("div",Ee,E(n.label),1))]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),body:r(l=>[u(ee,{props:l},{default:r(()=>[e.detailEditLock==!1?(v(),V(oe,{key:0},{default:r(()=>[t("a",{href:"#",onClick:M(n=>{console.log(l.row.word),e.onEditClick(l.row)},["prevent"])},[u(j,{name:"edit_note",color:"secondary",size:"md"})],8,Fe)]),_:2},1024)):L("",!0),(v(!0),f(Q,null,U(l.cols,n=>(v(),V(oe,{key:n.name,props:l,style:{"white-space":"normal","text-align":"left"}},{default:r(()=>[G(E(n.value),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),_:1},8,["title","rows","columns","style","filter","filter-method"])]),u(W,{modelValue:e.saveModalShow,"onUpdate:modelValue":o[10]||(o[10]=l=>e.saveModalShow=l),position:"top"},{default:r(()=>[u(K,{style:{"max-width":"700px"}},{default:r(()=>[u(me,null,{default:r(()=>[t("div",null,[t("div",Be,[De,u(D,{icon:"close",onClick:o[6]||(o[6]=l=>e.saveModalShow=!1),round:"",flat:""})]),t("div",Ve,[t("div",null,[u(_,{label:"\u3042\u3060\u540D",modelValue:e.insertCondition.key,"onUpdate:modelValue":o[7]||(o[7]=l=>e.insertCondition.key=l),class:"form-model","stack-label":"",style:{width:"250px"},clearable:"",dense:""},null,8,["modelValue"])]),t("div",null,[u(h,{modelValue:e.insertCondition.val,"onUpdate:modelValue":o[8]||(o[8]=l=>e.insertCondition.val=l)},null,8,["modelValue"])])]),e.records.filter(l=>l.val==e.insertCondition.val).length>0?(v(),f("div",qe,[Se,(v(!0),f(Q,null,U(e.records.filter(l=>l.val==e.insertCondition.val),l=>(v(),f("li",{key:l.key},E(l.key),1))),128))])):L("",!0),t("div",Ae,[u(D,{onClick:o[9]||(o[9]=M(l=>e.insertRecord(e.insertCondition.key,e.insertCondition.val),["prevent"])),label:"\u8FFD\u52A0",color:"primary",outline:"",icon:"note_add",loading:e.isSaveLoading,disable:e.insertCondition.key==""||e.insertCondition.val==""},null,8,["loading","disable"])]),t("div",Le,E(e.insertErr),1)])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),u(W,{modelValue:e.editModalShow,"onUpdate:modelValue":o[16]||(o[16]=l=>e.editModalShow=l)},{default:r(()=>[u(K,null,{default:r(()=>[u(k,null,{default:r(()=>[t("div",Ne,[t("div",Qe,[Me,u(D,{icon:"close",onClick:o[11]||(o[11]=l=>e.editModalShow=!1),round:"",flat:""})]),$e,t("div",Re,[u(_,{label:"\u3042\u3060\u540D",modelValue:e.updateCondition.key,"onUpdate:modelValue":o[12]||(o[12]=l=>e.updateCondition.key=l),class:"form-model",dense:"",outlined:"","stack-label":"",style:{width:"250px"}},null,8,["modelValue"]),u(_,{label:"\u30AD\u30E3\u30E9\u540D",modelValue:e.updateCondition.val,"onUpdate:modelValue":o[13]||(o[13]=l=>e.updateCondition.val=l),class:"form-model",dense:"",outlined:"","stack-label":"",style:{width:"250px"},readonly:""},null,8,["modelValue"])]),e.records.filter(l=>l.val==e.updateCondition.val).length>0?(v(),f("ul",Ue,[_e,(v(!0),f(Q,null,U(e.records.filter(l=>l.val==e.updateCondition.val),l=>(v(),f("li",{key:l.key},E(l.key),1))),128))])):L("",!0),Te,t("div",He,[u(D,{onClick:o[14]||(o[14]=M(l=>e.updateRecord(e.updateCondition.key,e.updateCondition.val),["prevent"])),label:"\u66F4\u65B0",color:"primary",outline:"",icon:"note_add",style:{"margin-right":"auto"},loading:e.isSaveLoading},null,8,["loading"]),t("div",Ie,E(e.updateErr),1),u(D,{onClick:o[15]||(o[15]=M(l=>e.deleteCheckModalShow=!0,["prevent"])),label:"\u524A\u9664",color:"negative",outline:"",icon:"note_add"})])])]),_:1})]),_:1})]),_:1},8,["modelValue"]),u(W,{modelValue:e.deleteCheckModalShow,"onUpdate:modelValue":o[19]||(o[19]=l=>e.deleteCheckModalShow=l)},{default:r(()=>[u(K,null,{default:r(()=>[u(k,null,{default:r(()=>[t("div",Je,[t("div",Oe,[Pe,u(D,{icon:"close",onClick:o[17]||(o[17]=l=>e.deleteCheckModalShow=!1),round:"",flat:""})]),ze,je,u(ve,{label:"\u3042\u3060\u540D","stack-label":""},{default:r(()=>[G(E(e.updateCondition.key),1)]),_:1}),t("div",Ge,[u(D,{onClick:o[18]||(o[18]=M(l=>e.deleteRecord(e.updateCondition.key,e.updateCondition.val),["prevent"])),label:"\u524A\u9664\u3059\u308B",color:"negative",outline:"",icon:"note_add",dense:"",loading:e.isDeleteLoading},null,8,["loading"])])])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}var We=ue(ge,[["render",Ke]]);const Xe=te({name:"word-list",components:{"name-list-table":We},setup(){const e=m(document.documentElement.scrollHeight*.85);return{filter:m(""),pageHeight:e}}});function Ye(e,o,y,C,b,F){const h=T("name-list-table");return v(),V(ne,{class:""},{default:r(()=>[u(h,{modelValue:e.filter,"onUpdate:modelValue":o[0]||(o[0]=c=>e.filter=c),height:e.pageHeight},null,8,["modelValue","height"])]),_:1})}var El=ue(Xe,[["render",Ye]]);export{El as default};
