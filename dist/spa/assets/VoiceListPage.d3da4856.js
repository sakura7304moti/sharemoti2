import{Q as C}from"./QPage.82e76fcb.js";import{r as i,d as k,_ as N,o as s,c as p,w as r,e as m,b as u,ac as $,ad as h,ae as g,aa as f,ab as y,f as b,ag as v,af as w,g as E,ah as F,a as T}from"./index.14a7c722.js";import{u as U,Q as D}from"./use-quasar.7a6bd282.js";import{Q as L}from"./QField.3dd07fc9.js";import{a as V,Q as _,b as B,c as q}from"./QTable.8542a644.js";import{A as H,d as I}from"./BaseApi.ab9ec937.js";import"./QDialog.946db96e.js";import"./use-prevent-scroll.49273e16.js";import"./use-tick.7b8fea28.js";import"./focus-manager.02955f48.js";import"./QSeparator.2e92d9dc.js";import"./use-dark.7ce8ffd6.js";import"./QList.0b3bac39.js";import"./QSelect.c55664e6.js";import"./QChip.15935488.js";import"./QItem.0cb08ef4.js";import"./QItemLabel.d7165eea.js";import"./position-engine.ef89f240.js";import"./format.2a3572e1.js";import"./QCheckbox.9468544f.js";import"./use-checkbox.812d2cd3.js";class P extends H{search(){const o="/voice/search",n=this.combineUrl(o);return this.httpGet(n)}async download(o){const n=`/voice/download?id=${o}`,d=this.combineUrl(n);await I({url:d,method:"GET",responseType:"blob"}).then(l=>{if(l)return console.log("download",l),l})}}const Q=new P;function S(){const e=U(),o=i(""),n=i(-1),d=[{name:"fileName",label:"\u30D5\u30A1\u30A4\u30EB\u540D",field:"fileName",sortable:!0}],l=i({search:!1,download:!1}),c=i([]);return{filter:o,columns:d,load:l,records:c,search:async function(){l.value.search=!0,await Q.search().then(t=>{t&&(console.log("search",t),c.value.splice(0),t.records.forEach(A=>c.value.push(A)))}).catch(t=>{console.log(t),e.notify({color:"red",position:"top",message:"\u30C7\u30FC\u30BF\u306E\u53D6\u5F97\u306B\u5931\u6557\u3057\u307E\u3057\u305F"})}),l.value.search=!1},selectId:n}}const z=k({name:"table-voice-list",props:{modelValue:{type:String,required:!0},label:{type:String,required:!1,default:"\u30DC\u30A4\u30B91\u3064100\u305F\u304B\u3057\u30DA\u30EA\u30AB"},height:{type:Number,required:!1,default:700}},setup(e){const{columns:o,load:n,records:d,search:l,selectId:c}=S();return l(),{condition:i(e.modelValue),tableName:i(e.label),tableHeight:i(e.height+"px"),columns:o,load:n,records:d,search:l,api:Q,selectId:c,playUrl:i(""),playName:i("")}}}),G={class:"row q-gutter-md",style:{width:"700px"}},M={key:3,class:"text-caption"},j={key:0},J=["src"],K={style:{width:"250px"}},O=["href","onClick"];function R(e,o,n,d,l,c){return e.load.search?h("",!0):(s(),p(q,{key:0,title:e.tableName,rows:e.records,columns:e.columns,"row-key":"id",style:F({height:e.tableHeight}),separator:"cell","rows-per-page-label":"\u8868\u793A\u884C\u6570","no-results-label":"\u898B\u3064\u304B\u3089\u306A\u304B\u3063\u305F...","no-data-label":"\u898B\u3064\u304B\u3089\u306A\u304B\u3063\u305F...",pagination:{rowsPerPage:0},"rows-per-page-options":[0],filter:e.condition,class:"voice-list-table"},{"top-right":r(()=>[m("div",G,[m("div",null,[u(D,{dense:"",debounce:"300",modelValue:e.condition,"onUpdate:modelValue":o[1]||(o[1]=a=>e.condition=a),placeholder:"\u691C\u7D22",style:{width:"200px"},align:"left"},{append:r(()=>[e.load.search?(s(),p($,{key:0,modelValue:e.load.search,"onUpdate:modelValue":o[0]||(o[0]=a=>e.load.search=a),color:"primary",size:"md"},null,8,["modelValue"])):h("",!0),e.condition.length==0?(s(),p(g,{key:1,name:"search"})):(s(),p(g,{key:2,name:"search",color:"primary"})),e.records.length>0?(s(),f("div",M,y(e.records.length),1)):h("",!0)]),_:1},8,["modelValue"])]),e.playName!=""&&e.playUrl!=""?(s(),f("div",j,[m("audio",{controls:"",src:e.playUrl,autoplay:""},null,8,J),u(L,{borderless:"",style:{height:"18px"}},{default:r(()=>[b(y(e.playName),1)]),_:1})])):h("",!0)])]),header:r(a=>[u(_,{props:a},{default:r(()=>[u(V,{style:{width:"50px"}},{default:r(()=>[b("\u518D\u751F")]),_:1}),(s(!0),f(w,null,v(a.cols,t=>(s(),p(V,{key:t.name,props:a},{default:r(()=>[m("div",K,y(t.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),body:r(a=>[u(_,{props:a},{default:r(()=>[u(B,null,{default:r(()=>[m("a",{href:e.api.apiEndpoint()+"/voice/download?id="+a.row.id,onClick:E(t=>{console.log("play",a.row),e.playUrl=e.api.apiEndpoint()+"/voice/download?id="+a.row.id,e.playName=a.row.fileName},["prevent"]),class:"play-btn"},[u(g,{name:"play_circle",color:"primary",size:"sm"})],8,O)]),_:2},1024),(s(!0),f(w,null,v(a.cols,t=>(s(),p(B,{key:t.name,props:a,style:{"white-space":"normal","text-align":"left"}},{default:r(()=>[b(y(t.value),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),_:1},8,["title","rows","columns","style","filter"]))}var W=N(z,[["render",R]]);const X=k({name:"voice-list",components:{"voice-list-table":W},setup(){const e=i(document.documentElement.scrollHeight*.85);return{filter:i(""),pageHeight:e}}});function Y(e,o,n,d,l,c){const a=T("voice-list-table");return s(),p(C,{class:""},{default:r(()=>[u(a,{modelValue:e.filter,"onUpdate:modelValue":o[0]||(o[0]=t=>e.filter=t),height:e.pageHeight},null,8,["modelValue","height"])]),_:1})}var ve=N(X,[["render",Y]]);export{ve as default};
