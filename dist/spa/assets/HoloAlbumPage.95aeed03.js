import{r as g,_ as H,d as j,k as A,a as G,o as t,c as h,w as d,e as n,aa as i,b as u,ac as J,ad as m,g as k,ae as E,af as D,ag as Q,Q as _,ab as C}from"./index.14a7c722.js";import{Q as I}from"./QRadio.d2ea2ae3.js";import{Q as B}from"./QPagination.51a6a30d.js";import{Q as N}from"./QCardSection.d3461790.js";import{Q as P}from"./QCard.856b109b.js";import{Q as U}from"./QSelect.c55664e6.js";import{u as K,Q as W}from"./use-quasar.7a6bd282.js";import{c as X,a as $,Q as O,b as z}from"./QTable.8542a644.js";import{Q as T}from"./QDialog.946db96e.js";import{Q as Z}from"./QPage.82e76fcb.js";import{a as R}from"./HoloSongApi.0cd4f589.js";import{Y as x}from"./vue3-youtube.umd.1f7ea524.js";import"./use-dark.7ce8ffd6.js";import"./use-checkbox.812d2cd3.js";import"./format.2a3572e1.js";import"./QField.3dd07fc9.js";import"./BaseApi.ab9ec937.js";import"./focus-manager.02955f48.js";import"./QChip.15935488.js";import"./QItem.0cb08ef4.js";import"./QItemLabel.d7165eea.js";import"./position-engine.ef89f240.js";import"./use-tick.7b8fea28.js";import"./use-prevent-scroll.49273e16.js";import"./QSeparator.2e92d9dc.js";import"./QList.0b3bac39.js";import"./QCheckbox.9468544f.js";function ee(){const{getVideoId:e,getImageLink:l,getDisplayName:V}=oe(),p=K(),v=[{name:"member",label:"\u30E1\u30F3\u30D0\u30FC",field:"member",sortable:!0},{name:"songName",label:"\u66F2\u540D",field:"songName",sortable:!0},{name:"date",label:"\u6295\u7A3F\u65E5",field:"date",sortable:!0},{name:"detail",label:"\u8A73\u7D30",field:"detail",sortable:!0}],f=g([]),w=g("gallery"),o=g([]),a=g({selectLink:"",pageNo:1,totalPages:1,pageSize:20,records:[]}),S=g([]),L=async function(){S.value.splice(0),await R.holoList().then(r=>{r&&(console.log("holo member",r),r.forEach(s=>S.value.push(s)),console.log("max length",Math.max(...S.value.map(s=>s.length))))}).catch(r=>{console.log(r),p.notify({color:"red",position:"top",message:"\u30C7\u30FC\u30BF\u306E\u53D6\u5F97\u306B\u5931\u6557\u3057\u307E\u3057\u305F"})})},c=g([]),b=g(!1),M=g(!1),q=async function(){b.value=!0,L(),o.value.splice(0),await R.ori().then(r=>{r&&(r.records.forEach(s=>{if(s.link.includes("you")&&!s.detail.includes("\u975E\u516C\u958B")){const F={date:s.date,member:s.member,link:s.link.replace("youtu.be/","www.youtube.com/watch?v="),songName:s.songName,detail:s.detail,imageLink:l(s.link),videoId:e(s.link)};o.value.push(F)}}),o.value.reverse(),console.log("add list",o.value.length),a.value.totalPages=Math.ceil(o.value.length/a.value.pageSize),y(),f.value.splice(0),o.value.forEach(s=>{f.value.push({member:s.member,displayMember:V(s.member),songName:s.songName,date:s.date,detail:s.detail,link:s.link})}),c.value.splice(0),c.value=[...new Set(o.value.map(s=>s.songName.trim()))],c.value.sort(),console.log("songs",c.value.length))}).catch(r=>{console.log(r),p.notify({color:"red",position:"top",message:"\u30C7\u30FC\u30BF\u306E\u53D6\u5F97\u306B\u5931\u6557\u3057\u307E\u3057\u305F"})}),b.value=!1},y=function(){a.value.records.splice(0);const r=Math.max(a.value.pageNo-1,-1)*a.value.pageSize,s=Math.min(r+a.value.pageSize-1,o.value.length);o.value.slice(r,s).forEach(F=>{a.value.records.push(F)}),console.log("data",a.value)};return{quasar:p,records:o,holoMembers:S,pageState:a,isLoading:b,searchOptionShow:M,rows:f,columns:v,displayMode:w,songList:c,select:q,selectPage:y,getMembers:L}}function oe(){const e=function(p){const v=p.split("v=")[1];return v!=null?v:p.split("/")[p.split("/").length-1]};return{getVideoId:e,getImageLink:function(p){return"https://img.youtube.com/vi/query/maxresdefault.jpg".replace("query",e(p))},getDisplayName:function(p){return p.length>19?p.substring(0,19)+"...":p}}}const le=j({name:"holosong-page",components:{YouTube:x},setup(){const{records:e,pageState:l,isLoading:V,searchOptionShow:p,rows:v,columns:f,displayMode:w,holoMembers:o,songList:a,select:S,selectPage:L}=ee();S();const c=g(""),b=g("");A(c,()=>{c.value!=""&&(b.value=c.value,c.value="")});const M=g([]);a.value.forEach(r=>M.value.push(r));const q=(r,s)=>{s(()=>{const F=r.toLowerCase();M.value=a.value.filter(Y=>Y.toLowerCase().indexOf(F)>-1)})},y=g("");return A(y,()=>{y.value!=""&&(b.value=y.value,y.value="")}),{filter:b,selectedMember:c,records:e,pageState:l,isLoading:V,searchOptionShow:p,rows:v,columns:f,displayMode:w,holoMembers:o,songList:a,selectPage:L,songOptions:M,filterFn:q,songInput:y,songModalShow:g(!1)}}}),ae=n("div",{class:"text-h5 q-pb-md"},"\u30DB\u30ED\u30E9\u30A4\u30D6\u30AA\u30EA\u66F2\u307E\u3068\u3081",-1),te={key:0,id:"holo-page-loading",class:"row q-gutter-md"},se=n("div",{class:"text-subtitle1 text-primary"},"\u691C\u7D22\u4E2D...",-1),ne={key:1,class:"q-pa-md row q-gutter-md"},ue={key:0,class:"row q-gutter-md q-pb-md"},ie={key:2,id:"holo-song-cards",style:{"min-height":"780px"}},de={class:"row q-gutter-md"},re=["href","onClick"],pe=["src"],me={key:3,class:"row q-gutter-md q-pt-md"},ge={class:"q-pa-md"},ce={class:"holosong-container"},he={class:"holosong-left-content"},ve={key:0},ye={key:1},fe={key:0,class:"holosong-video-container"},be=n("div",{class:"holosong-video-placeholder"},[n("i",{class:"holosong-play-icon"},"\u25B6\uFE0F"),n("div",{class:"text-white"},"\u52D5\u753B\u306F\u3053\u3053\u3067\u518D\u751F\u3055\u308C\u308B\u3088")],-1),ke=[be],we={class:"holosong-right-content"},Se={class:"q-pr-md no-shadow"},Ce=n("div",{class:"q-pl-md"},null,-1),Ve={key:0,style:{width:"200px"}},Me={key:1,style:{width:"200px"}},Fe={key:2,style:{width:"100px"}},Le={key:3,style:{width:"100px"}},Ee={class:"no-shadow"},De={style:{"white-space":"normal","text-align":"left"}},Qe=n("div",{class:"text-h5"},"\u30DA\u30FC\u30B8\u9078\u629E",-1),qe=n("hr",null,null,-1),Be=n("div",{class:"text-h6"},"\u66F2\u4E00\u89A7",-1),Ne={class:"q-pa-md"},Pe=["onClick"],Ae={class:"holo-song-songli"};function _e(e,l,V,p,v,f){const w=G("YouTube");return t(),h(Z,{class:""},{default:d(()=>[n("div",null,[ae,e.isLoading?(t(),i("div",te,[u(J,{color:"primary",size:"3em"}),se])):m("",!0),e.pageState.selectLink!=""?(t(),i("div",ne,[!e.isLoading&&e.displayMode=="gallery"?(t(),h(w,{key:0,src:e.pageState.selectLink,onReady:o=>!0,ref:"youtube",vars:{autoplay:1,rel:0}},null,8,["src"])):m("",!0)])):m("",!0),n("div",null,[e.pageState.totalPages!=1?(t(),i("div",ue,[n("div",null,[u(I,{modelValue:e.displayMode,"onUpdate:modelValue":l[0]||(l[0]=o=>e.displayMode=o),val:"gallery",label:"\u30B5\u30E0\u30CD\u30A4\u30EB",dense:"",class:"q-pr-xs"},null,8,["modelValue"]),u(I,{modelValue:e.displayMode,"onUpdate:modelValue":l[1]||(l[1]=o=>e.displayMode=o),val:"table",label:"\u30C6\u30FC\u30D6\u30EB",dense:""},null,8,["modelValue"])]),!e.isLoading&&e.displayMode=="gallery"?(t(),h(B,{key:0,modelValue:e.pageState.pageNo,"onUpdate:modelValue":l[2]||(l[2]=o=>e.pageState.pageNo=o),max:e.pageState.totalPages,"direction-links":"","max-pages":10,onClick:k(e.selectPage,["prevent"]),class:"q-pl-md",outlined:""},null,8,["modelValue","max","onClick"])):m("",!0),!e.isLoading&&e.displayMode=="gallery"?(t(),i("a",{key:1,href:"#",onClick:l[3]||(l[3]=k(o=>e.searchOptionShow=!0,["prevent","stop"]))},[u(E,{name:"view_list",color:"primary",size:"md"})])):m("",!0)])):m("",!0)]),e.displayMode=="gallery"?(t(),i("div",ie,[n("div",de,[(t(!0),i(D,null,Q(e.pageState.records,o=>(t(),i("div",{key:o.link,class:"q-pa-sm"},[u(P,{style:{width:"100%","max-width":"250px"}},{default:d(()=>[u(N,null,{default:d(()=>[n("a",{href:o.link,onClick:k(a=>e.pageState.selectLink=o.link,["prevent"])},[n("img",{src:o.imageLink,style:{width:"100%","max-width":"250px"}},null,8,pe)],8,re)]),_:2},1024)]),_:2},1024)]))),128))])])):m("",!0),e.pageState.totalPages!=1&&!e.isLoading&&e.displayMode=="gallery"?(t(),i("div",me,[u(B,{modelValue:e.pageState.pageNo,"onUpdate:modelValue":l[4]||(l[4]=o=>e.pageState.pageNo=o),max:e.pageState.totalPages,"direction-links":"","max-pages":10,onClick:k(e.selectPage,["prevent"]),class:"q-pb-md",outlined:""},null,8,["modelValue","max","onClick"]),n("a",{href:"#",onClick:l[5]||(l[5]=k(o=>e.searchOptionShow=!0,["prevent","stop"]))},[u(E,{name:"view_list",color:"primary",size:"md"})])])):m("",!0)]),n("div",ge,[n("div",ce,[n("div",he,[e.pageState.selectLink!=""?(t(),i("div",ve,[!e.isLoading&&e.displayMode=="table"?(t(),h(w,{key:0,src:e.pageState.selectLink,onReady:o=>!0,ref:"youtube",vars:{autoplay:1,rel:0}},null,8,["src"])):m("",!0)])):(t(),i("div",ye,[e.displayMode=="table"?(t(),i("div",fe,ke)):m("",!0)]))]),n("div",we,[!e.isLoading&&e.displayMode=="table"?(t(),h(X,{key:0,rows:e.rows,columns:e.columns,"row-key":"link",filter:e.filter,separator:"cell","rows-per-page-label":"\u8868\u793A\u884C\u6570","no-results-label":"\u898B\u3064\u304B\u3089\u306A\u304B\u3063\u305F...",pagination:{rowsPerPage:0},"rows-per-page-options":[0],class:"holoalbum-list-table"},{"top-right":d(()=>[n("div",Se,[u(_,{icon:"queue_music",dense:"",onClick:l[6]||(l[6]=o=>e.songModalShow=!0),round:""})]),u(U,{modelValue:e.songInput,"onUpdate:modelValue":l[7]||(l[7]=o=>e.songInput=o),style:{width:"200px"},dense:"","use-input":"","stack-label":"",label:"\u66F2\u540D",class:"q-pr-md",options:e.songOptions,onFilter:e.filterFn},null,8,["modelValue","options","onFilter"]),u(U,{modelValue:e.selectedMember,"onUpdate:modelValue":l[8]||(l[8]=o=>e.selectedMember=o),style:{width:"200px"},dense:"","stack-label":"",label:"\u30E1\u30F3\u30D0\u30FC",class:"q-pr-md",options:e.holoMembers},null,8,["modelValue","options"]),Ce,u(W,{dense:"",debounce:"300",modelValue:e.filter,"onUpdate:modelValue":l[9]||(l[9]=o=>e.filter=o),placeholder:"\u691C\u7D22"},{append:d(()=>[e.filter.length==0?(t(),h(E,{key:0,name:"search"})):(t(),h(E,{key:1,name:"search",color:"primary"}))]),_:1},8,["modelValue"])]),header:d(o=>[u(O,{props:o},{default:d(()=>[u($,{style:{width:"50px"}}),(t(!0),i(D,null,Q(o.cols,a=>(t(),h($,{key:a.name,props:o},{default:d(()=>[a.label=="\u30E1\u30F3\u30D0\u30FC"?(t(),i("div",Ve,C(a.label),1)):m("",!0),a.label=="\u66F2\u540D"?(t(),i("div",Me,C(a.label),1)):m("",!0),a.label=="\u6295\u7A3F\u65E5"?(t(),i("div",Fe,C(a.label),1)):m("",!0),a.label=="\u8A73\u7D30"?(t(),i("div",Le,C(a.label),1)):m("",!0)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),body:d(o=>[u(O,{props:o},{default:d(()=>[u(z,{style:{width:"50px"}},{default:d(()=>[n("div",Ee,[u(_,{size:"md",onClick:a=>e.pageState.selectLink=o.row.link,icon:"play_arrow","text-color":"primary",outline:""},null,8,["onClick"])])]),_:2},1024),(t(!0),i(D,null,Q(o.cols,a=>(t(),h(z,{key:a.name,props:o},{default:d(()=>[n("div",De,C(a.value),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),_:1},8,["rows","columns","filter"])):m("",!0)])])]),u(T,{modelValue:e.searchOptionShow,"onUpdate:modelValue":l[11]||(l[11]=o=>e.searchOptionShow=o)},{default:d(()=>[u(P,{style:{width:"400px"}},{default:d(()=>[u(N,null,{default:d(()=>[Qe,qe,u(B,{modelValue:e.pageState.pageNo,"onUpdate:modelValue":l[10]||(l[10]=o=>e.pageState.pageNo=o),max:e.pageState.totalPages,onClick:k(e.selectPage,["prevent"]),class:"q-pb-md",outlined:"",style:{width:"300px"}},null,8,["modelValue","max","onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),u(T,{modelValue:e.songModalShow,"onUpdate:modelValue":l[12]||(l[12]=o=>e.songModalShow=o)},{default:d(()=>[u(P,{style:{width:"400px"}},{default:d(()=>[u(N,null,{default:d(()=>[Be,n("div",Ne,[(t(!0),i(D,null,Q(e.songList,o=>(t(),i("ul",{key:o},[n("a",{href:"#",class:"holo-song-songitem text-subtitle1",onClick:k(a=>{e.filter=o,e.songModalShow=!1},["prevent"])},[n("li",Ae,C(o),1)],8,Pe)]))),128))])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}var po=H(le,[["render",_e]]);export{po as default};
