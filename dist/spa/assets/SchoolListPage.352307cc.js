import{u as E,Q as B}from"./use-quasar.7a6bd282.js";import{r as c,_ as Q,d as q,a as y,o as f,c as w,w as i,e as n,b as t,aC as D,Q as d,g as F,f as k,ab as _,aa as V,ag as I,af as $,ad as L}from"./index.14a7c722.js";import{Q as U}from"./QField.3dd07fc9.js";import{Q as h}from"./QCard.856b109b.js";import{Q as b}from"./QDialog.946db96e.js";import{Q as A}from"./QCardSection.d3461790.js";import{Q as P}from"./QPage.82e76fcb.js";import{A as S}from"./BaseApi.ab9ec937.js";import{l as N}from"./LockIcon.df8f6aff.js";import"./focus-manager.02955f48.js";import"./use-dark.7ce8ffd6.js";import"./use-prevent-scroll.49273e16.js";import"./use-tick.7b8fea28.js";class R extends S{search(l){const s="/schoolList/search",u=this.combineUrl(s);return this.httpPost(u,l)}save(l){const s="/schoolList/save",u=this.combineUrl(s);return this.httpPost(u,l)}delete(l){const s="/schoolList/delete",u=this.combineUrl(s);return this.httpPost(u,l)}}const C=new R;function K(){const e=E(),l=c({insert:!1,delete:!1}),s=c({search:"",insert:"",delete:""}),u=c({search:!1,insert:!1,delete:!1}),a=c([]);return{loading:u,modal:l,condition:s,records:a,search:async function(){u.value.search=!0,await C.search({word:s.value.search}).then(o=>{var r;o&&(console.log("select",o),a.value.splice(0),(r=o.records)==null||r.forEach(p=>{p.word&&a.value.push(p.word)}),a.value.sort())}).catch(o=>{console.log(o),e.notify({color:"red",position:"top",message:"\u30C7\u30FC\u30BF\u306E\u53D6\u5F97\u306B\u5931\u6557\u3057\u307E\u3057\u305F"})}),u.value.search=!1},insert:async function(){a.value.includes(s.value.insert)?e.notify({color:"red",position:"top",message:"\u540C\u3058\u5B66\u6821\u304C\u3059\u3067\u306B...\u3042\u308B\u308F\u3088\uFF01"}):(u.value.insert=!0,await C.save({word:s.value.insert.replace(/\n/g,"")}).then(o=>{o&&(console.log("insert",o),a.value.push(s.value.insert),a.value.sort(),s.value.insert="",e.notify({color:"blue",position:"top",message:"\u65B0\u3057\u3044\u5B66\u6821\u304C...\u51FA\u308B\u308F\u3088\uFF01"}))}).catch(o=>{console.log(o),e.notify({color:"red",position:"top",message:"\u30C7\u30FC\u30BF\u306E\u8FFD\u52A0\u306B\u5931\u6557\u3057\u307E\u3057\u305F"})})),u.value.insert=!1},deleteRec:async function(){await C.delete({word:s.value.delete}).then(o=>{if(o)if(console.log("delete",o),o.status){e.notify({color:"blue",position:"top",message:"\u524A\u9664\u5B8C\u4E86\u3057\u307E\u3057\u305F"});const r=a.value.findIndex(p=>p==s.value.delete);a.value.splice(r,1),l.value.delete=!1}else e.notify({color:"red",position:"top",message:"\u30C7\u30FC\u30BF\u306E\u524A\u9664\u306B\u5931\u6557\u3057\u307E\u3057\u305F"})}).catch(o=>{console.log(o),e.notify({color:"red",position:"top",message:"\u30C7\u30FC\u30BF\u306E\u524A\u9664\u306B\u5931\u6557\u3057\u307E\u3057\u305F"})}),l.value.delete=!1}}}const M=q({name:"school-list",components:{"lock-icon":N},setup(){const{loading:e,modal:l,condition:s,records:u,search:a,insert:v,deleteRec:m}=K();return a(),{loading:e,modal:l,condition:s,records:u,search:a,insert:v,deleteRec:m,deleteIcon:c(!0)}}}),T=n("div",{class:"q-pb-md text-h5"},"\u5B66\u6821\u4E00\u89A7",-1),j={class:"row q-gutter-md"},z={class:"text-subtitle1 row q-gutter-md"},G=n("div",{style:{"margin-right":"auto"}},"\u65B0\u898F\u8FFD\u52A0",-1),H=n("hr",null,null,-1),J={class:"row q-gutter-md"},O={class:"text-subtitle1 row q-gutter-md"},W=n("div",{style:{"margin-right":"auto"}},"\u524A\u9664\u78BA\u8A8D",-1),X=n("hr",null,null,-1),Y=n("div",null,"\u6B21\u306E\u5B66\u6821\u3092\u524A\u9664\u3057\u3066\u3082\u3044\u3044\u304B\u306A\uFF1F",-1),Z={class:"q-pa-md"},x=n("hr",null,null,-1),ee={class:"q-pt-md"},oe={class:"row q-gutter-md"},le={key:0};function te(e,l,s,u,a,v){const m=y("lock-icon"),g=y("q-section");return f(),w(P,{class:""},{default:i(()=>[T,n("div",j,[t(U,{dense:"",class:"form-model"},{default:i(()=>[t(B,{label:"\u5B66\u6821\u540D",modelValue:e.condition.search,"onUpdate:modelValue":l[0]||(l[0]=o=>e.condition.search=o),class:"form-model",dense:"","stack-label":"",onKeydown:D(e.search,["enter"])},null,8,["modelValue","onKeydown"]),t(d,{color:"primary",dense:"",icon:"search",onClick:e.search,loading:e.loading.search},null,8,["onClick","loading"])]),_:1}),t(d,{label:"\u8FFD\u52A0","icon-right":"note_add",color:"grey-6",outline:"",onClick:l[1]||(l[1]=o=>e.modal.insert=!0),dense:""}),t(m,{modelValue:e.deleteIcon,"onUpdate:modelValue":l[2]||(l[2]=o=>e.deleteIcon=o),onEventChange:l[3]||(l[3]=o=>e.deleteIcon=o),class:"q-pt-sm"},null,8,["modelValue"])]),n("div",null,[t(b,{modelValue:e.modal.insert,"onUpdate:modelValue":l[6]||(l[6]=o=>e.modal.insert=o)},{default:i(()=>[t(h,{class:"q-pa-md",style:{width:"500px"}},{default:i(()=>[t(g,null,{default:i(()=>[n("div",z,[G,t(d,{icon:"close",onClick:l[4]||(l[4]=o=>e.modal.insert=!1),round:"",flat:""})]),H,n("div",J,[t(B,{label:"\u5B66\u6821\u540D",modelValue:e.condition.insert,"onUpdate:modelValue":l[5]||(l[5]=o=>e.condition.insert=o),class:"form-model",dense:"",outlined:"","stack-label":"",style:{width:"250px"},clearable:""},null,8,["modelValue"]),t(d,{label:"\u8FFD\u52A0",onClick:F(e.insert,["prevent"]),outline:"",icon:"note_add",loading:e.loading.insert},null,8,["onClick","loading"])])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),n("div",null,[t(b,{modelValue:e.modal.delete,"onUpdate:modelValue":l[9]||(l[9]=o=>e.modal.delete=o)},{default:i(()=>[t(h,{class:"q-pa-md",style:{width:"500px"}},{default:i(()=>[t(g,null,{default:i(()=>[n("div",O,[W,t(d,{icon:"close",onClick:l[7]||(l[7]=o=>e.modal.delete=!1),round:"",flat:""})]),X,Y,n("div",Z,[t(h,{style:{width:"200px"}},{default:i(()=>[t(A,null,{default:i(()=>[k(_(e.condition.delete),1)]),_:1})]),_:1})]),x,n("div",null,[t(d,{onClick:l[8]||(l[8]=F(o=>e.deleteRec(),["prevent"])),label:"\u524A\u9664\u3059\u308B",color:"red",outline:"",icon:"delete",loading:e.loading.delete},null,8,["loading"])])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),n("div",ee,[n("div",oe,[(f(!0),V($,null,I(e.records,o=>(f(),w(h,{key:o},{default:i(()=>[t(A,null,{default:i(()=>[k(_(o)+" ",1),e.deleteIcon==!1?(f(),V("div",le,[t(d,{icon:"delete",outline:"",color:"red",dense:"",onClick:F(r=>{e.condition.delete=o,e.modal.delete=!0},["prevent"])},null,8,["onClick"])])):L("",!0)]),_:2},1024)]),_:2},1024))),128))])])]),_:1})}var ge=Q(M,[["render",te]]);export{ge as default};
